<div class="activity-header">
  <span>Recent Activity</span>
  <% if unread_notifications_count > 0 %>
    <button type="button" class="mark-read-btn" data-action="click->activity-menu#markRead">
      Mark as Read
    </button>
  <% end %>
</div>
<div class="activity-content-compact" id="activity-content-compact">
  <% if total_activity_count > 0 %>
    <% if pending_approvals_count > 0 %>
      <% pending_approvals.each do |approval| %>
        <%= link_to film_path(approval.film), class: "activity-item" do %>
          <div class="activity-type-badge approval">Approval Needed</div>
          <div class="activity-item-title"><%= approval.film.title %></div>
          <div class="activity-item-desc">You've been tagged as <%= approval.approval_type.titleize %></div>
          <div class="activity-item-time"><%= time_ago_in_words(approval.created_at) %> ago</div>
        <% end %>
      <% end %>
    <% end %>
    <% unread_grouped.each do |group| %>
      <%= render partial: "shared/notification_group", locals: { group: group, is_unread: true } %>
    <% end %>
  <% else %>
    <div class="activity-empty">
      <div style="font-size: 32px; margin-bottom: 8px; opacity: 0.3;">âœ“</div>
      <div>No new activity</div>
    </div>
  <% end %>

  <% if has_more_notifications %>
    <button type="button" class="expand-notifications-btn" data-action="click->activity-menu#toggleExpand">
      <span class="expand-text">Show All Notifications</span>
      <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-left: 4px;">
        <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  <% end %>
</div>

<div class="activity-content-expanded" id="activity-content-expanded" style="display: none;">
  <% all_grouped.each do |group| %>
    <%= render partial: "shared/notification_group", locals: { group: group, is_unread: group[:notifications].any? { |n| n.read_at.nil? } } %>
  <% end %>

  <button type="button" class="expand-notifications-btn" data-action="click->activity-menu#toggleExpand">
    <span class="expand-text">Show Less</span>
    <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-left: 4px; transform: rotate(180deg);">
      <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>
</div>
